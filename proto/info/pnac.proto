// Copyright(c) 2025 Zededa, Inc.
// All rights reserved.

syntax = "proto3";

package org.lfedge.eve.info;

option go_package = "github.com/lf-edge/eve-api/go/info";
option java_package = "org.lfedge.eve.info";

import "google/protobuf/timestamp.proto";

// Device-reported status of Port-Based Network Access Control (PNAC)
// using IEEE 802.1X on a specific network port.
message PNACStatus {
  // Indicates whether 802.1X authentication is enabled on this port.
  bool enabled = 1;

  // Current supplicant state as reported by the 802.1X client.
  SupplicantState state = 2;

  // Timestamp of the most recent successful 802.1X authentication.
  // Unset if authentication has not yet completed successfully.
  google.protobuf.Timestamp last_auth_timestamp = 3;

  // Optional errors reported by the supplicant.
  // May include authentication failures, certificate errors, or timeouts.
  repeated string errors = 4;
}

// IEEE 802.1X supplicant states as observed on the device.
enum SupplicantState {
  SUPPLICANT_STATE_UNSPECIFIED = 0;
  // Supplicant is idle or link is down; no authentication in progress.
  SUPPLICANT_STATE_DISCONNECTED = 1;
  // Link is up and the supplicant is initiating authentication.
  SUPPLICANT_STATE_CONNECTING = 2;
  // Active EAP authentication exchange is in progress.
  SUPPLICANT_STATE_AUTHENTICATING = 3;
  // Authentication completed successfully; port is authorized.
  SUPPLICANT_STATE_AUTHENTICATED = 4;
  // Authentication failed and access was not granted.
  SUPPLICANT_STATE_FAILED = 5;
  // Supplicant is in a held or backoff state following repeated failures.
  SUPPLICANT_STATE_HELD = 6;
}
